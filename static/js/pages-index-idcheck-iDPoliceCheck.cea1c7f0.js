(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-idcheck-iDPoliceCheck"],{"0dd7":function(e,t,n){"use strict";n("6a54");var a=n("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.base64ToPath=function(e){return new Promise((function(t,n){if("object"===("undefined"===typeof window?"undefined":(0,i.default)(window))&&"document"in window){e=e.split(",");var a=e[0].match(/:(.*?);/)[1],s=atob(e[1]),d=s.length,u=new Uint8Array(d);while(d--)u[d]=s.charCodeAt(d);return t((window.URL||window.webkitURL).createObjectURL(new Blob([u],{type:a})))}var c=e.split(",")[0].match(/data\:\S+\/(\S+);/);c?c=c[1]:n(new Error("base64 error"));var l=function(){return Date.now()+String(r++)}()+"."+c;if("object"!==("undefined"===typeof plus?"undefined":(0,i.default)(plus)))if("object"===("undefined"===typeof wx?"undefined":(0,i.default)(wx))&&wx.canIUse("getFileSystemManager")){f=wx.env.USER_DATA_PATH+"/"+l;wx.getFileSystemManager().writeFile({filePath:f,data:o(e),encoding:"base64",success:function(){t(f)},fail:function(e){n(e)}})}else n(new Error("not support"));else{var f="_doc/uniapp_temp/"+l;if(!function(e,t){for(var n=e.split("."),a=t.split("."),i=!1,o=0;o<a.length;o++){var r=n[o]-a[o];if(0!==r){i=r>0;break}}return i}("Android"===plus.os.name?"1.9.9.80627":"1.9.9.80472",plus.runtime.innerVersion))return void plus.io.resolveLocalFileSystemURL("_doc",(function(a){a.getDirectory("uniapp_temp",{create:!0,exclusive:!1},(function(a){a.getFile(l,{create:!0,exclusive:!1},(function(a){a.createWriter((function(a){a.onwrite=function(){t(f)},a.onerror=n,a.seek(0),a.writeAsBinary(o(e))}),n)}),n)}),n)}),n);var p=new plus.nativeObj.Bitmap(l);p.loadBase64Data(e,(function(){p.save(f,{},(function(){p.clear(),t(f)}),(function(e){p.clear(),n(e)}))}),(function(e){p.clear(),n(e)}))}}))},t.pathToBase64=function(e){return new Promise((function(t,n){if("object"===("undefined"===typeof window?"undefined":(0,i.default)(window))&&"document"in window){if("function"===typeof FileReader){var a=new XMLHttpRequest;return a.open("GET",e,!0),a.responseType="blob",a.onload=function(){if(200===this.status){var e=new FileReader;e.onload=function(e){t(e.target.result)},e.onerror=n,e.readAsDataURL(this.response)}},a.onerror=n,void a.send()}var o=document.createElement("canvas"),r=o.getContext("2d"),s=new Image;return s.onload=function(){o.width=s.width,o.height=s.height,r.drawImage(s,0,0),t(o.toDataURL()),o.height=o.width=0},s.onerror=n,void(s.src=e)}"object"!==("undefined"===typeof plus?"undefined":(0,i.default)(plus))?"object"===("undefined"===typeof wx?"undefined":(0,i.default)(wx))&&wx.canIUse("getFileSystemManager")?wx.getFileSystemManager().readFile({filePath:e,encoding:"base64",success:function(e){t("data:image/png;base64,"+e.data)},fail:function(e){n(e)}}):n(new Error("not support")):plus.io.resolveLocalFileSystemURL(function(e){if(0===e.indexOf("_www")||0===e.indexOf("_doc")||0===e.indexOf("_documents")||0===e.indexOf("_downloads"))return e;if(0===e.indexOf("file://"))return e;if(0===e.indexOf("/storage/emulated/0/"))return e;if(0===e.indexOf("/")){var t=plus.io.convertAbsoluteFileSystem(e);if(t!==e)return t;e=e.substr(1)}return"_www/"+e}(e),(function(e){e.file((function(e){var a=new plus.io.FileReader;a.onload=function(e){t(e.target.result)},a.onerror=function(e){n(e)},a.readAsDataURL(e)}),(function(e){n(e)}))}),(function(e){n(e)}))}))};var i=a(n("fcf3"));function o(e){var t=e.split(",");return t[t.length-1]}n("5ef2"),n("bf0f"),n("7a76"),n("c9b5"),n("5c47"),n("2c10"),n("15d1"),n("d5c6"),n("5a56"),n("f074"),n("4db2"),n("c976"),n("4d8f"),n("7b97"),n("668a"),n("c5b7"),n("8ff5"),n("2378"),n("641a"),n("64e0"),n("cce3"),n("efba"),n("d009"),n("bd7d"),n("7edd"),n("d798"),n("f547"),n("5e54"),n("b60a"),n("8c18"),n("12973"),n("f991"),n("198e"),n("8557"),n("63b1"),n("1954"),n("1cf1"),n("18f7"),n("de6c"),n("dc89"),n("2425");var r=0},"1e85":function(e,t,n){"use strict";n.r(t);var a=n("7a0a"),i=n("ea72");for(var o in i)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("cb1c");var r=n("828b"),s=Object(r["a"])(i["default"],a["b"],a["c"],!1,null,"c3e2aed2",null,!1,a["a"],void 0);t["default"]=s.exports},"7a0a":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){}));var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"page"},[n("v-uni-view",{staticClass:"card"},[n("v-uni-input",{staticClass:"uni-input",attrs:{focus:!0,placeholder:"请输入注册用户名称"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.onKeyUserNameInput.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"row-space"},[n("v-uni-text",{staticClass:"text-tips"},[e._v("剩余 "+e._s(e.residue_times)+" 次")]),n("v-uni-button",{staticClass:"small-btn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.queryRemainTimes.apply(void 0,arguments)}}},[e._v("查询剩余次数")])],1)],1),n("v-uni-view",{staticClass:"card"},[n("v-uni-view",{staticClass:"head-container"},[n("v-uni-view",{staticClass:"avatar-box",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.previewAvatar.apply(void 0,arguments)}}},[n("v-uni-image",{staticClass:"avatar",attrs:{src:e.localHeadUrl,mode:"aspectFill"}})],1),n("v-uni-button",{staticClass:"upload-btn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.uploadAvatar.apply(void 0,arguments)}}},[e._v("选择要匹配的照片")])],1),n("v-uni-view",{staticClass:"form-group"},[n("v-uni-text",{staticClass:"label"},[e._v("请输入姓名")]),n("v-uni-input",{staticClass:"uni-input",attrs:{placeholder:"请输入姓名"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.onKeyNameInput.apply(void 0,arguments)}}})],1),n("v-uni-view",{staticClass:"form-group"},[n("v-uni-text",{staticClass:"label"},[e._v("请输入18位身份证号码")]),n("v-uni-input",{staticClass:"uni-input",attrs:{type:"idcard",maxlength:"18",placeholder:"请输入18位身份证号码"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.onKeyIdInput.apply(void 0,arguments)}}})],1)],1),n("v-uni-button",{staticClass:"generate-btn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.recPloiceInfo.apply(void 0,arguments)}}},[e._v("查询")]),n("v-uni-view",{staticClass:"card result-box"},[n("v-uni-text",{staticClass:"label"},[e._v("结果：")]),n("v-uni-text",{staticClass:"result-text"},[e._v(e._s(e.result))])],1)],1)},i=[]},b502:function(e,t,n){var a=n("c1fe");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var i=n("967d").default;i("98d77988",a,!0,{sourceMap:!1,shadowMode:!1})},c1fe:function(e,t,n){var a=n("c86c");t=a(!1),t.push([e.i,".page[data-v-c3e2aed2]{padding:%?20?%;background:#f5f7fa;min-height:100vh}.card[data-v-c3e2aed2]{background:#fff;border-radius:%?20?%;padding:%?30?%;margin-bottom:%?30?%;box-shadow:0 %?6?% %?16?% rgba(0,0,0,.08)}.uni-input[data-v-c3e2aed2]{border:%?1?% solid #ddd;border-radius:%?12?%;padding:%?20?%;margin-top:%?10?%;font-size:%?28?%;background:#fafafa}.row-space[data-v-c3e2aed2]{flex-direction:row;justify-content:space-between;align-items:center;display:flex;margin-top:%?20?%}.text-tips[data-v-c3e2aed2]{font-size:%?26?%;color:#888}.label[data-v-c3e2aed2]{font-size:%?28?%;font-weight:500;color:#333;margin-bottom:%?10?%;display:block}.form-group[data-v-c3e2aed2]{margin-top:%?20?%}.generate-btn[data-v-c3e2aed2]{width:100%;background:linear-gradient(90deg,#4facfe,#00f2fe);color:#fff;font-size:%?32?%;padding:%?20?% 0;border-radius:%?16?%;margin:%?20?% 0;box-shadow:0 %?8?% %?18?% rgba(0,180,255,.25)}.small-btn[data-v-c3e2aed2]{background:#4facfe;color:#fff;font-size:%?24?%;padding:%?10?% %?20?%;border-radius:%?12?%}.head-container[data-v-c3e2aed2]{flex-direction:row;align-items:center;display:flex;margin-bottom:%?20?%}.avatar-box[data-v-c3e2aed2]{width:%?140?%;height:%?140?%;border-radius:50%;overflow:hidden;margin-right:%?20?%;border:%?2?% solid #eee}.avatar[data-v-c3e2aed2]{width:100%;height:100%}.upload-btn[data-v-c3e2aed2]{background:#ff9800;color:#fff;font-size:%?26?%;padding:%?16?% %?30?%;border-radius:%?12?%}.result-box[data-v-c3e2aed2]{flex-direction:row;align-items:center;display:flex}.result-text[data-v-c3e2aed2]{font-size:%?30?%;color:#007aff;margin-left:%?10?%}.notice[data-v-c3e2aed2]{background:#fff7e6;border:%?1?% solid #ffd591}.notice-text[data-v-c3e2aed2]{font-size:%?26?%;color:#666;line-height:1.6;white-space:pre-line}",""]),e.exports=t},cb1c:function(e,t,n){"use strict";var a=n("b502"),i=n.n(a);i.a},d9e5:function(e,t,n){"use strict";n("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("5c47"),n("a1c1"),n("5ef2");var a=n("0dd7"),i={data:function(){return{localHeadUrl:"",user_name:"",residue_times:0,name:"",idcard:"",result:""}},onLoad:function(){},onUnload:function(){},methods:{onKeyUserNameInput:function(e){this.user_name=e.detail.value},onKeyNameInput:function(e){this.name=e.detail.value},onKeyIdInput:function(e){this.idcard=e.target.value},uploadAvatar:function(){var e=this;uni.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(t){e.localHeadUrl=t.tempFilePaths[0]},fail:function(e){console.error("失败",e)}})},previewAvatar:function(){uni.previewImage({urls:[this.localHeadUrl],current:this.localHeadUrl,indicator:"default",loop:!1})},queryRemainTimes:function(){if(""!=this.user_name){var e=this;uni.showLoading({title:"查询中..."}),uni.request({url:"https://hzmttserver.onrender.com/querySfzNewUser?user_phone_number="+e.user_name+"&key=appSFZ1681884202hzmtt",method:"GET",success:function(t){console.log(t),uni.hideLoading(),t.data.data[0]?e.residue_times=t.data.data[0].residue_times:uni.showToast({title:"查无数据，请确认输入注册昵称正确",icon:"none"})},fail:function(e){uni.hideLoading(),console.log(e)}})}else uni.showToast({title:"注册昵称不能为空",icon:"none"})},recPloiceInfo:function(){var e=this;if(this.residue_times<1)uni.showToast({title:"剩余次数不足，请输入您的注册昵称查询剩余次数或联系管理员",icon:"none"});else{var t=uni.getStorageSync("ACCESS_TOKEN");if(console.log(t),""!==this.localHeadUrl)if(""!=this.name)if(""!=this.idcard)if(18==this.idcard.length){var n=this;uni.showLoading({title:"查询中..."}),(0,a.pathToBase64)(this.localHeadUrl).then((function(a){uni.request({url:"https://aip.baidubce.com/rest/2.0/face/v3/person/verify?access_token="+t,method:"POST",data:{image:a.replace("data:image/jpeg;base64,",""),image_type:"BASE64",id_card_number:e.idcard,name:e.name},header:{"Content-Type":"application/json"},success:function(t){console.log(t),n.residue_times=n.residue_times-1,n.updateUserInfo();var a=t.data.error_code;if(0==a){var i=t.data.result.score;e.result=i>85?"匹配度："+i+"%，是本人！":"匹配度仅为："+i+"%，匹配度过低，请再次确认是否本人！"}else{console.log(t.data);var o=t.data.error_msg;-1!=o.indexOf("id number and name not match")?e.result="身份证号码与姓名不匹配！":-1!=o.indexOf("param[id_card_number] format error")?e.result="身份证号码格式不正确!":-1!=o.indexOf("id number and name not match or id number not exist")?e.result="身份证号与姓名不匹配或该身份证号不存在！":-1!=o.indexOf("person picture is low quality")?e.result="确认图片上的人脸是否清晰, 不能有多张人脸, 不合格的话请重新拍摄！":-1!=o.indexOf("police picture is none or low quality")?e.result="此用户的信息没有被公安数据覆盖到！":-1!=o.indexOf("id number not exist")?e.result="公安库里不存在此身份证号！":e.result=o}uni.hideLoading(),e.localHeadUrl=""},fail:function(e){console.log(e),uni.hideLoading()}})})).catch((function(e){console.error(e),uni.hideLoading()}))}else uni.showModal({content:"请输入18位身份证号码",showCancel:!1});else uni.showModal({content:"身份证号码不能为空",showCancel:!1});else uni.showModal({content:"姓名不能为空",showCancel:!1});else uni.showModal({content:"请选择头像上传",showCancel:!1})}},updateUserInfo:function(){uni.request({url:"https://hzmttserver.onrender.com/updateSfzNewUserRemainTime?user_phone_number="+this.user_name+"&residue_times="+this.residue_times+"&key=appSFZ1681884202hzmtt",method:"GET",success:function(e){console.log(e)},fail:function(e){uni.hideLoading(),console.log(e)}})}}};t.default=i},ea72:function(e,t,n){"use strict";n.r(t);var a=n("d9e5"),i=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=i.a}}]);