(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-textToImage"],{"0dd7":function(e,t,n){"use strict";n("6a54");var i=n("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.base64ToPath=function(e){return new Promise((function(t,n){if("object"===("undefined"===typeof window?"undefined":(0,a.default)(window))&&"document"in window){e=e.split(",");var i=e[0].match(/:(.*?);/)[1],d=atob(e[1]),s=d.length,u=new Uint8Array(s);while(s--)u[s]=d.charCodeAt(s);return t((window.URL||window.webkitURL).createObjectURL(new Blob([u],{type:i})))}var c=e.split(",")[0].match(/data\:\S+\/(\S+);/);c?c=c[1]:n(new Error("base64 error"));var l=function(){return Date.now()+String(r++)}()+"."+c;if("object"!==("undefined"===typeof plus?"undefined":(0,a.default)(plus)))if("object"===("undefined"===typeof wx?"undefined":(0,a.default)(wx))&&wx.canIUse("getFileSystemManager")){f=wx.env.USER_DATA_PATH+"/"+l;wx.getFileSystemManager().writeFile({filePath:f,data:o(e),encoding:"base64",success:function(){t(f)},fail:function(e){n(e)}})}else n(new Error("not support"));else{var f="_doc/uniapp_temp/"+l;if(!function(e,t){for(var n=e.split("."),i=t.split("."),a=!1,o=0;o<i.length;o++){var r=n[o]-i[o];if(0!==r){a=r>0;break}}return a}("Android"===plus.os.name?"1.9.9.80627":"1.9.9.80472",plus.runtime.innerVersion))return void plus.io.resolveLocalFileSystemURL("_doc",(function(i){i.getDirectory("uniapp_temp",{create:!0,exclusive:!1},(function(i){i.getFile(l,{create:!0,exclusive:!1},(function(i){i.createWriter((function(i){i.onwrite=function(){t(f)},i.onerror=n,i.seek(0),i.writeAsBinary(o(e))}),n)}),n)}),n)}),n);var p=new plus.nativeObj.Bitmap(l);p.loadBase64Data(e,(function(){p.save(f,{},(function(){p.clear(),t(f)}),(function(e){p.clear(),n(e)}))}),(function(e){p.clear(),n(e)}))}}))},t.pathToBase64=function(e){return new Promise((function(t,n){if("object"===("undefined"===typeof window?"undefined":(0,a.default)(window))&&"document"in window){if("function"===typeof FileReader){var i=new XMLHttpRequest;return i.open("GET",e,!0),i.responseType="blob",i.onload=function(){if(200===this.status){var e=new FileReader;e.onload=function(e){t(e.target.result)},e.onerror=n,e.readAsDataURL(this.response)}},i.onerror=n,void i.send()}var o=document.createElement("canvas"),r=o.getContext("2d"),d=new Image;return d.onload=function(){o.width=d.width,o.height=d.height,r.drawImage(d,0,0),t(o.toDataURL()),o.height=o.width=0},d.onerror=n,void(d.src=e)}"object"!==("undefined"===typeof plus?"undefined":(0,a.default)(plus))?"object"===("undefined"===typeof wx?"undefined":(0,a.default)(wx))&&wx.canIUse("getFileSystemManager")?wx.getFileSystemManager().readFile({filePath:e,encoding:"base64",success:function(e){t("data:image/png;base64,"+e.data)},fail:function(e){n(e)}}):n(new Error("not support")):plus.io.resolveLocalFileSystemURL(function(e){if(0===e.indexOf("_www")||0===e.indexOf("_doc")||0===e.indexOf("_documents")||0===e.indexOf("_downloads"))return e;if(0===e.indexOf("file://"))return e;if(0===e.indexOf("/storage/emulated/0/"))return e;if(0===e.indexOf("/")){var t=plus.io.convertAbsoluteFileSystem(e);if(t!==e)return t;e=e.substr(1)}return"_www/"+e}(e),(function(e){e.file((function(e){var i=new plus.io.FileReader;i.onload=function(e){t(e.target.result)},i.onerror=function(e){n(e)},i.readAsDataURL(e)}),(function(e){n(e)}))}),(function(e){n(e)}))}))};var a=i(n("fcf3"));function o(e){var t=e.split(",");return t[t.length-1]}n("5ef2"),n("bf0f"),n("7a76"),n("c9b5"),n("5c47"),n("2c10"),n("15d1"),n("d5c6"),n("5a56"),n("f074"),n("4db2"),n("c976"),n("4d8f"),n("7b97"),n("668a"),n("c5b7"),n("8ff5"),n("2378"),n("641a"),n("64e0"),n("cce3"),n("efba"),n("d009"),n("bd7d"),n("7edd"),n("d798"),n("f547"),n("5e54"),n("b60a"),n("8c18"),n("12973"),n("f991"),n("198e"),n("8557"),n("63b1"),n("1954"),n("1cf1"),n("18f7"),n("de6c"),n("dc89"),n("2425");var r=0},"187f":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",[n("v-uni-view",{staticClass:"content"},[n("v-uni-textarea",{staticClass:"text-area",attrs:{maxlength:"400",placeholder:"[主体], [细节], [风格], [环境], [光线], [视角]","auto-height":"false"},model:{value:e.userPrompt,callback:function(t){e.userPrompt=t},expression:"userPrompt"}}),n("v-uni-text",{staticClass:"tips"},[e._v("请输入英文、内容最好包含[主体], [细节], [风格], [环境], [光线], [视角]\n\t\t\t每张图片预计2分钟内生成")]),n("v-uni-view",{staticClass:"uni-btn-v"},[n("v-uni-button",{attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.doGeneratePrompt.apply(void 0,arguments)}}},[e._v("生成")])],1),n("v-uni-text",{staticClass:"content"},[e._v("请选择增强描述，然后耐心等待，每张图片预计2分钟内生成")]),n("v-uni-scroll-view",{staticClass:"scroll-container",attrs:{"scroll-x":"true"}},e._l(e.promptOptions,(function(t,i){return n("v-uni-view",{key:i,staticClass:"paylist-card",on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.doCreate(t)}}},[n("v-uni-textarea",{staticClass:"text-area",attrs:{placeholder:"","auto-height":"false"},model:{value:e.promptOptions[i],callback:function(t){e.$set(e.promptOptions,i,t)},expression:"promptOptions[index]"}})],1)})),1),n("v-uni-view",{staticClass:"img-bg"},[n("v-uni-image",{staticClass:"imagead",attrs:{src:e.imageResultPath},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.previewResultImage.apply(void 0,arguments)}}})],1),n("v-uni-text",{staticClass:"content"},[e._v("生成历史")]),n("v-uni-view",{staticClass:"image-grid"},e._l(e.imageLists,(function(t,i){return n("v-uni-view",{key:i,staticClass:"image-cell",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.preview(i)}}},[n("v-uni-image",{staticStyle:{width:"100%",height:"100px"},attrs:{src:"data:image/png;base64,"+t.base64,mode:"aspectFit"}})],1)})),1)],1)],1)},a=[]},"816f":function(e,t,n){var i=n("c86c");t=i(!1),t.push([e.i,".uni-padding-wrap[data-v-d9296eba]{\n\t/* width:690rpx; */padding:0 %?30?%}.uni-common-mt[data-v-d9296eba]{margin-top:%?30?%}.content[data-v-d9296eba]{margin:%?30?%;display:flex;flex-direction:column;align-items:center;justify-content:center}.text-box[data-v-d9296eba]{margin-bottom:%?40?%;padding:%?40?% 0;display:flex;min-height:%?300?%;background-color:#fff;justify-content:center;align-items:center;text-align:center;font-size:%?30?%;color:#353535;line-height:1.8}.uni-title[data-v-d9296eba]{margin-top:%?40?%;font-size:%?30?%;font-weight:500;padding:%?20?% 0;line-height:1.5}.course-column[data-v-d9296eba]{flex:1;text-align:center;padding:%?20?%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:%?26?%}.paylist-card[data-v-d9296eba]{background:#fff;padding:%?30?%;border-radius:%?16?%;margin-right:%?20?%;border:%?2?% solid #e0e0e0;box-shadow:0 %?6?% %?12?% rgba(0,0,0,.05);min-width:%?300?%; /* 让卡片有固定宽度 */text-align:center;flex-shrink:0}.scroll-container[data-v-d9296eba]{width:100%;white-space:nowrap}.uni-common-pl[data-v-d9296eba]{padding-left:%?30?%}.grid-container[data-v-d9296eba]{display:flex;flex-wrap:wrap;justify-content:space-between}.grid-item[data-v-d9296eba]{width:23%; /* 留出间距 */margin-bottom:10px}.uni-list[data-v-d9296eba]{background-color:#fff;position:relative;width:100%;display:flex;flex-direction:column}.uni-list-cell[data-v-d9296eba]{position:relative;display:flex;flex-direction:row;justify-content:space-between;align-items:center}.uni-list-cell-left[data-v-d9296eba]{white-space:nowrap;font-size:%?28?%;padding:0 %?30?%}.uni-list-cell-db[data-v-d9296eba],\n.uni-list-cell-right[data-v-d9296eba]{flex:1}.text-area[data-v-d9296eba]{margin:%?30?%;width:90%;height:%?300?%;border:1px solid #ccc;border-radius:%?12?%;padding:%?20?%;font-size:%?36?%;line-height:1.8;background-color:#fdfdfd;box-shadow:0 %?2?% %?8?% rgba(0,0,0,.05)}.uni-result-wrapper[data-v-d9296eba]{height:%?300?%;width:80%;margin:%?20?%;background-color:#123fff}.uni-input[data-v-d9296eba]{height:auto;padding:%?15?% %?25?%;line-height:%?50?%;font-size:%?28?%;background:#fff;flex:1}\n\n/* textarea */.uni-textarea[data-v-d9296eba]{width:100%;background:#fff}.uni-textarea uni-textarea[data-v-d9296eba]{width:96%;padding:%?18?% 2%;line-height:1.6;font-size:%?28?%;height:%?150?%}.input-result[data-v-d9296eba]{height:auto;width:80%;margin:%?20?%;padding:%?20?%;font-size:%?26?%;background:#fff;color:#353535}\n\n/* 表单 */.uni-form-item[data-v-d9296eba]{display:flex;width:100%;padding:%?10?% 0}.uni-form-item .title[data-v-d9296eba]{padding:%?10?% %?25?%}.content[data-v-d9296eba]{width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center}.btn_translate_bg[data-v-d9296eba]{margin-top:%?40?%;width:70%;margin-left:%?40?%;margin-right:%?40?%;background-color:#128f94}.text-area[data-v-d9296eba]{display:flex;justify-content:center}.title[data-v-d9296eba]{font-size:%?36?%;color:#8f8f94}.result[data-v-d9296eba]{font-size:%?24?%;color:#128f94}.uni-btn-v[data-v-d9296eba]{margin:%?40?%;padding:%?10?% 0}.img-bg[data-v-d9296eba]{width:400px;height:400px;margin:%?30?%;background-color:#fff}.imagead[data-v-d9296eba]{margin:%?20?%;width:400px;min-width:%?400?%;height:400px;background-color:#eee}.image-grid[data-v-d9296eba]{display:flex;flex-wrap:wrap; /* 允许换行 */justify-content:left /* 可选对齐方式 */}.image-cell[data-v-d9296eba]{width:10%; /* 每行显示 N 个 */padding:20px /* 可选留空隙 */}",""]),e.exports=t},"8cd0":function(e,t,n){"use strict";n.r(t);var i=n("f96a"),a=n.n(i);for(var o in i)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(o);t["default"]=a.a},9505:function(e,t,n){"use strict";var i=n("c6d5"),a=n.n(i);a.a},c6d5:function(e,t,n){var i=n("816f");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var a=n("967d").default;a("07959b86",i,!0,{sourceMap:!1,shadowMode:!1})},cfdc:function(e,t,n){"use strict";n.r(t);var i=n("187f"),a=n("8cd0");for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);n("9505");var r=n("828b"),d=Object(r["a"])(a["default"],i["b"],i["c"],!1,null,"d9296eba",null,!1,i["a"],void 0);t["default"]=d.exports},f96a:function(e,t,n){"use strict";n("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("fd3c");var i=n("0dd7"),a={data:function(){return{userPrompt:"",promptOptions:[],imageResultPath:"",imageLists:[]}},onLoad:function(){this.getHistoryImage()},methods:{doGeneratePrompt:function(){if(this.userPrompt){console.log(this.userPrompt);var e=this;uni.showLoading({title:"处理中..."}),uni.request({url:"https://7112-210-19-68-82.ngrok-free.app/ai/api_prompt_suggestions",method:"POST",header:{"Content-Type":"application/json"},data:{prompt:e.userPrompt},timeout:12e4,success:function(t){uni.hideLoading(),t.data.suggestions&&(e.promptOptions=t.data.suggestions,console.log(e.promptOptions))},fail:function(e){uni.hideLoading(),console.log(e)}})}else uni.showToast({title:"请输入内容",icon:"none"})},doCreate:function(e){var t=this;uni.showModal({title:"提示",content:"确定文生图？",success:function(n){if(n.confirm){console.log(e);var a=t;uni.showLoading({title:"处理中...预计2分钟内处理完成..."}),uni.request({url:"https://7112-210-19-68-82.ngrok-free.app/ai/api_generate_images",method:"POST",header:{"Content-Type":"application/json"},data:{prompt:e},timeout:6e5,success:function(e){uni.hideLoading(),e.data[0]&&(0,i.base64ToPath)("data:image/png;base64,"+e.data[0]).then((function(e){a.imageResultPath=e})).catch((function(e){console.error("失败：",e)}))},fail:function(e){uni.hideLoading(),console.log(e)}})}}})},previewResultImage:function(){""!=this.imageResultPath&&uni.previewImage({urls:[this.imageResultPath]})},getHistoryImage:function(){var e=this;uni.showLoading({title:"处理中..."}),uni.request({url:"https://7112-210-19-68-82.ngrok-free.app/ai/api_list_images",method:"POST",header:{"Content-Type":"application/json"},success:function(t){uni.hideLoading(),t.data&&(e.imageLists=t.data)},fail:function(e){uni.hideLoading(),console.log(e)}})},preview:function(e){var t=this.imageLists.map((function(e){return"data:image/png;base64,"+e.base64}));uni.previewImage({current:t[e],urls:t})}}};t.default=a}}]);