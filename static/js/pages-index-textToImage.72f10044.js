(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-textToImage"],{"0dd7":function(t,e,i){"use strict";i("6a54");var n=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.base64ToPath=function(t){return new Promise((function(e,i){if("object"===("undefined"===typeof window?"undefined":(0,a.default)(window))&&"document"in window){t=t.split(",");var n=t[0].match(/:(.*?);/)[1],s=atob(t[1]),d=s.length,l=new Uint8Array(d);while(d--)l[d]=s.charCodeAt(d);return e((window.URL||window.webkitURL).createObjectURL(new Blob([l],{type:n})))}var c=t.split(",")[0].match(/data\:\S+\/(\S+);/);c?c=c[1]:i(new Error("base64 error"));var u=function(){return Date.now()+String(r++)}()+"."+c;if("object"!==("undefined"===typeof plus?"undefined":(0,a.default)(plus)))if("object"===("undefined"===typeof wx?"undefined":(0,a.default)(wx))&&wx.canIUse("getFileSystemManager")){f=wx.env.USER_DATA_PATH+"/"+u;wx.getFileSystemManager().writeFile({filePath:f,data:o(t),encoding:"base64",success:function(){e(f)},fail:function(t){i(t)}})}else i(new Error("not support"));else{var f="_doc/uniapp_temp/"+u;if(!function(t,e){for(var i=t.split("."),n=e.split("."),a=!1,o=0;o<n.length;o++){var r=i[o]-n[o];if(0!==r){a=r>0;break}}return a}("Android"===plus.os.name?"1.9.9.80627":"1.9.9.80472",plus.runtime.innerVersion))return void plus.io.resolveLocalFileSystemURL("_doc",(function(n){n.getDirectory("uniapp_temp",{create:!0,exclusive:!1},(function(n){n.getFile(u,{create:!0,exclusive:!1},(function(n){n.createWriter((function(n){n.onwrite=function(){e(f)},n.onerror=i,n.seek(0),n.writeAsBinary(o(t))}),i)}),i)}),i)}),i);var p=new plus.nativeObj.Bitmap(u);p.loadBase64Data(t,(function(){p.save(f,{},(function(){p.clear(),e(f)}),(function(t){p.clear(),i(t)}))}),(function(t){p.clear(),i(t)}))}}))},e.pathToBase64=function(t){return new Promise((function(e,i){if("object"===("undefined"===typeof window?"undefined":(0,a.default)(window))&&"document"in window){if("function"===typeof FileReader){var n=new XMLHttpRequest;return n.open("GET",t,!0),n.responseType="blob",n.onload=function(){if(200===this.status){var t=new FileReader;t.onload=function(t){e(t.target.result)},t.onerror=i,t.readAsDataURL(this.response)}},n.onerror=i,void n.send()}var o=document.createElement("canvas"),r=o.getContext("2d"),s=new Image;return s.onload=function(){o.width=s.width,o.height=s.height,r.drawImage(s,0,0),e(o.toDataURL()),o.height=o.width=0},s.onerror=i,void(s.src=t)}"object"!==("undefined"===typeof plus?"undefined":(0,a.default)(plus))?"object"===("undefined"===typeof wx?"undefined":(0,a.default)(wx))&&wx.canIUse("getFileSystemManager")?wx.getFileSystemManager().readFile({filePath:t,encoding:"base64",success:function(t){e("data:image/png;base64,"+t.data)},fail:function(t){i(t)}}):i(new Error("not support")):plus.io.resolveLocalFileSystemURL(function(t){if(0===t.indexOf("_www")||0===t.indexOf("_doc")||0===t.indexOf("_documents")||0===t.indexOf("_downloads"))return t;if(0===t.indexOf("file://"))return t;if(0===t.indexOf("/storage/emulated/0/"))return t;if(0===t.indexOf("/")){var e=plus.io.convertAbsoluteFileSystem(t);if(e!==t)return e;t=t.substr(1)}return"_www/"+t}(t),(function(t){t.file((function(t){var n=new plus.io.FileReader;n.onload=function(t){e(t.target.result)},n.onerror=function(t){i(t)},n.readAsDataURL(t)}),(function(t){i(t)}))}),(function(t){i(t)}))}))};var a=n(i("fcf3"));function o(t){var e=t.split(",");return e[e.length-1]}i("5ef2"),i("bf0f"),i("7a76"),i("c9b5"),i("5c47"),i("2c10"),i("15d1"),i("d5c6"),i("5a56"),i("f074"),i("4db2"),i("c976"),i("4d8f"),i("7b97"),i("668a"),i("c5b7"),i("8ff5"),i("2378"),i("641a"),i("64e0"),i("cce3"),i("efba"),i("d009"),i("bd7d"),i("7edd"),i("d798"),i("f547"),i("5e54"),i("b60a"),i("8c18"),i("12973"),i("f991"),i("198e"),i("8557"),i("63b1"),i("1954"),i("1cf1"),i("18f7"),i("de6c"),i("dc89"),i("2425");var r=0},3504:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("v-uni-view",{staticClass:"content"},[i("v-uni-picker",{attrs:{range:t.styleOptions},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.onStyleChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker"},[t._v("风格："+t._s(t.selectedStyle))])],1),i("v-uni-textarea",{staticClass:"text-area",attrs:{maxlength:"400",placeholder:"[主体], [细节], [风格], [环境], [光线], [视角]","auto-height":"false"},model:{value:t.userPrompt,callback:function(e){t.userPrompt=e},expression:"userPrompt"}}),i("v-uni-text",{staticClass:"tips"},[t._v("请输入英文、内容最好包含[主体], [细节], [风格], [环境], [光线], [视角]\n\t\t\t每张图片预计2分钟内生成")]),i("v-uni-view",{staticClass:"uni-btn-v"},[i("v-uni-button",{attrs:{type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.doGeneratePrompt.apply(void 0,arguments)}}},[t._v("生成")])],1),i("v-uni-text",{staticClass:"content"},[t._v("请选择增强描述，然后耐心等待，每张图片预计2分钟内生成")]),i("v-uni-scroll-view",{staticClass:"scroll-container",attrs:{"scroll-x":"true"}},t._l(t.promptOptions,(function(e,n){return i("v-uni-view",{key:n,staticClass:"paylist-card",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.doCreate(e)}}},[i("v-uni-textarea",{staticClass:"text-area",attrs:{placeholder:"","auto-height":"false"},model:{value:t.promptOptions[n],callback:function(e){t.$set(t.promptOptions,n,e)},expression:"promptOptions[index]"}})],1)})),1),i("v-uni-view",{staticClass:"img-bg"},[i("v-uni-image",{staticClass:"imagead",attrs:{src:t.imageResultPath},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.previewResultImage.apply(void 0,arguments)}}})],1),i("v-uni-text",{staticClass:"content"},[t._v("生成历史")]),i("v-uni-view",{staticClass:"image-grid"},t._l(t.imageLists,(function(e,n){return i("v-uni-view",{key:n,staticClass:"image-cell",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.preview(n)}}},[i("v-uni-image",{staticStyle:{width:"100%",height:"100px"},attrs:{src:"data:image/png;base64,"+e.base64,mode:"aspectFit"}})],1)})),1)],1)],1)},a=[]},"8cd0":function(t,e,i){"use strict";i.r(e);var n=i("f96a"),a=i.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a},a0c6:function(t,e,i){var n=i("ec2f");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("967d").default;a("5301776d",n,!0,{sourceMap:!1,shadowMode:!1})},bdd9:function(t,e,i){"use strict";var n=i("a0c6"),a=i.n(n);a.a},cfdc:function(t,e,i){"use strict";i.r(e);var n=i("3504"),a=i("8cd0");for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);i("bdd9");var r=i("828b"),s=Object(r["a"])(a["default"],n["b"],n["c"],!1,null,"52761932",null,!1,n["a"],void 0);e["default"]=s.exports},ec2f:function(t,e,i){var n=i("c86c");e=n(!1),e.push([t.i,".uni-padding-wrap[data-v-52761932]{\n\t/* width:690rpx; */padding:0 %?30?%}.uni-common-mt[data-v-52761932]{margin-top:%?30?%}.content[data-v-52761932]{margin:%?30?%;display:flex;flex-direction:column;align-items:center;justify-content:center}.text-box[data-v-52761932]{margin-bottom:%?40?%;padding:%?40?% 0;display:flex;min-height:%?300?%;background-color:#fff;justify-content:center;align-items:center;text-align:center;font-size:%?30?%;color:#353535;line-height:1.8}.uni-title[data-v-52761932]{margin-top:%?40?%;font-size:%?30?%;font-weight:500;padding:%?20?% 0;line-height:1.5}.course-column[data-v-52761932]{flex:1;text-align:center;padding:%?20?%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:%?26?%}.paylist-card[data-v-52761932]{background:#fff;padding:%?30?%;border-radius:%?16?%;margin-right:%?20?%;border:%?2?% solid #e0e0e0;box-shadow:0 %?6?% %?12?% rgba(0,0,0,.05);min-width:%?300?%; /* 让卡片有固定宽度 */text-align:center;flex-shrink:0}.scroll-container[data-v-52761932]{width:100%;white-space:nowrap}.uni-common-pl[data-v-52761932]{padding-left:%?30?%}.grid-container[data-v-52761932]{display:flex;flex-wrap:wrap;justify-content:space-between}.grid-item[data-v-52761932]{width:23%; /* 留出间距 */margin-bottom:10px}.uni-list[data-v-52761932]{background-color:#fff;position:relative;width:100%;display:flex;flex-direction:column}.uni-list-cell[data-v-52761932]{position:relative;display:flex;flex-direction:row;justify-content:space-between;align-items:center}.uni-list-cell-left[data-v-52761932]{white-space:nowrap;font-size:%?28?%;padding:0 %?30?%}.uni-list-cell-db[data-v-52761932],\n.uni-list-cell-right[data-v-52761932]{flex:1}.text-area[data-v-52761932]{margin:%?30?%;width:90%;height:%?300?%;border:1px solid #ccc;border-radius:%?12?%;padding:%?20?%;font-size:%?36?%;line-height:1.8;background-color:#fdfdfd;box-shadow:0 %?2?% %?8?% rgba(0,0,0,.05)}.uni-result-wrapper[data-v-52761932]{height:%?300?%;width:80%;margin:%?20?%;background-color:#123fff}.uni-input[data-v-52761932]{height:auto;padding:%?15?% %?25?%;line-height:%?50?%;font-size:%?28?%;background:#fff;flex:1}\n\n/* textarea */.uni-textarea[data-v-52761932]{width:100%;background:#fff}.uni-textarea uni-textarea[data-v-52761932]{width:96%;padding:%?18?% 2%;line-height:1.6;font-size:%?28?%;height:%?150?%}.input-result[data-v-52761932]{height:auto;width:80%;margin:%?20?%;padding:%?20?%;font-size:%?26?%;background:#fff;color:#353535}\n\n/* 表单 */.uni-form-item[data-v-52761932]{display:flex;width:100%;padding:%?10?% 0}.uni-form-item .title[data-v-52761932]{padding:%?10?% %?25?%}.content[data-v-52761932]{width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center}.btn_translate_bg[data-v-52761932]{margin-top:%?40?%;width:70%;margin-left:%?40?%;margin-right:%?40?%;background-color:#128f94}.text-area[data-v-52761932]{display:flex;justify-content:center}.title[data-v-52761932]{font-size:%?36?%;color:#8f8f94}.result[data-v-52761932]{font-size:%?24?%;color:#128f94}.uni-btn-v[data-v-52761932]{margin:%?40?%;padding:%?10?% 0}.img-bg[data-v-52761932]{width:400px;height:400px;margin:%?30?%;background-color:#fff}.imagead[data-v-52761932]{margin:%?20?%;width:400px;min-width:%?400?%;height:400px;background-color:#eee}.image-grid[data-v-52761932]{display:flex;flex-wrap:wrap; /* 允许换行 */justify-content:left /* 可选对齐方式 */}.image-cell[data-v-52761932]{width:10%; /* 每行显示 N 个 */padding:20px /* 可选留空隙 */}",""]),t.exports=e},f96a:function(t,e,i){"use strict";i("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("fd3c");var n=i("0dd7"),a={data:function(){return{styleOptions:["写实人像/场景","动漫/二次元","奇幻插画风","油画/古典艺术","童话梦幻风","儿童故事插画","历史圣经插图","神话幻想题材","现代科幻","圣经场景重现"],stylePromptMap:{"写实人像/场景":"A realistic portrait or detailed scene of","动漫/二次元":"An anime-style illustration of","奇幻插画风":"A fantasy illustration of","油画/古典艺术":"An oil painting in classical art style of","童话梦幻风":"A dreamy fairy tale illustration of","儿童故事插画":"A whimsical children story illustration of","历史圣经插图":"A historical biblical illustration of","神话幻想题材":"A fantasy mythological illustration of","现代科幻":"A modern sci-fi illustration of","圣经场景重现":"A realistic cinematic recreation of the biblical scene of"},selectedStyle:"写实人像/场景",defaultPrompt:"A realistic portrait / scene",userPrompt:"",promptOptions:[],imageResultPath:"",imageLists:[]}},onLoad:function(){this.getHistoryImage()},methods:{onStyleChange:function(t){var e=t.detail.value;this.selectedStyle=this.styleOptions[e],console.log(this.selectedStyle),this.defaultPrompt=this.stylePromptMap[this.selectedStyle],console.log(this.defaultPrompt)},doGeneratePrompt:function(){if(this.userPrompt){console.log(this.userPrompt);var t=this;uni.showLoading({title:"处理中..."}),uni.request({url:"https://7112-210-19-68-82.ngrok-free.app/ai/api_prompt_suggestions",method:"POST",header:{"Content-Type":"application/json"},data:{prompt:t.userPrompt},timeout:6e5,success:function(e){uni.hideLoading(),e.data.suggestions&&(t.promptOptions=e.data.suggestions,console.log(t.promptOptions))},fail:function(t){uni.hideLoading(),console.log(t)}})}else uni.showToast({title:"请输入内容",icon:"none"})},doCreate:function(t){var e=this;uni.showModal({title:"提示",content:"确定文生图？",success:function(i){if(i.confirm){console.log(t);var a=e;uni.showLoading({title:"处理中..."}),uni.request({url:"https://7112-210-19-68-82.ngrok-free.app/ai/api_generate_images",method:"POST",header:{"Content-Type":"application/json"},data:{prompt:a.defaultPrompt+": "+t},timeout:6e5,success:function(t){uni.hideLoading(),t.data[0]&&(0,n.base64ToPath)("data:image/png;base64,"+t.data[0]).then((function(t){a.imageResultPath=t})).catch((function(t){console.error("失败：",t)}))},fail:function(t){uni.hideLoading(),console.log(t)}})}}})},previewResultImage:function(){""!=this.imageResultPath&&uni.previewImage({urls:[this.imageResultPath]})},getHistoryImage:function(){var t=this;uni.showLoading({title:"处理中..."}),uni.request({url:"https://7112-210-19-68-82.ngrok-free.app/ai/api_list_images",method:"POST",header:{"Content-Type":"application/json"},success:function(e){uni.hideLoading(),e.data&&(t.imageLists=e.data)},fail:function(t){uni.hideLoading(),console.log(t)}})},preview:function(t){var e=this.imageLists.map((function(t){return"data:image/png;base64,"+t.base64}));uni.previewImage({current:e[t],urls:e})}}};e.default=a}}]);